<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <script type="module" src="/bundle.mjs"></script>
</head>
<body>
  <canvas id="confetti-canvas"></canvas>
  <div id="flat-chat"></div>
  <div id="voiceflow-chat-frame"></div>
  <script type="module">
    import { VideoExtension,
             TimerExtension,
             FormExtension,
             MapExtension,
             FileUploadExtension,
             KBUploadExtension,
             DateExtension,
             ConfettiExtension,
             FeedbackExtension } from '/extensions.js';

    (function (d, t) {
      var v = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
      v.onload = function () {
        window.voiceflow.chat.load({
          verify: { projectID: '6655be76ce58376f4d1d93d8' },
          url: 'https://general-runtime.voiceflow.com',
          versionID: 'production',
          user: {
            name: 'Demo User',
          },
          render: {
            mode: 'overlay',
          },
          autostart: false,
          allowDangerousHTML: true,
          assistant: {
            extensions: [
              VideoExtension,
              TimerExtension,
              FormExtension,
              MapExtension,
              FileUploadExtension,
              KBUploadExtension,
              DateExtension,
              ConfettiExtension,
              FeedbackExtension,
            ],
          },
        }).then(() => {
          window.voiceflow.chat.proactive.clear(); // clear all previous messages

          // Delay the first proactive message
          setTimeout(function() {
            window.voiceflow.chat.proactive.push(
              { type: 'text', payload: { message: "Aloha Surfbreaker! üèÑ‚Äç‚ôÇÔ∏è" } }
            );
          }, 3000); // milliseconds delay for the first message adjust as needed

          // Delay the second proactive message
          setTimeout(function() {
            window.voiceflow.chat.proactive.push(
              { type: 'text', payload: { message: "Need help? üòä" } }
            );
          }, 5000); // Additional milliseconds delay for the second message adjust as needed

          // Delay opening the chat window to ensure the proactive messages are loaded
          setTimeout(function() {
            window.voiceflow.chat.open();
          }, 7500); // Adjust this delay if needed to open the chat after messages
        });
      };
      v.src = "https://yannicksegaar.github.io/RomAIx-VF-extensions/bundle.mjs";
      v.type = 'text/javascript';
      s.parentNode.insertBefore(v, s);
    })(document, 'script');

    // Render the ChatInputWithMenuButton component in the chat input area
    const chatInputArea = document.getElementById('voiceflow-chat-frame');
    const chatInputMenuButton = document.createElement('div');
    chatInputArea.appendChild(chatInputMenuButton);
    ReactDOM.render(React.createElement(window.ChatInputWithMenuButton), chatInputMenuButton);
  </script>
</body>
</html>